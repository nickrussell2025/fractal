<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FILMNET OS 1.0</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');

        /* CSS Variables for theming */
        :root {
            --primary: #00ff00;
            --primary-dim: #00aa00;
            --primary-dark: #004400;
            --primary-light: #00ff0033;
            --bg: #000;
            --text: #00ff00;
        }

        /* Color Schemes */
        [data-theme="blue"] {
            --primary: #00aaff;
            --primary-dim: #0066aa;
            --primary-dark: #003366;
            --primary-light: #00aaff33;
            --text: #00aaff;
        }

        [data-theme="orange"] {
            --primary: #ff8800;
            --primary-dim: #aa5500;
            --primary-dark: #663300;
            --primary-light: #ff880033;
            --text: #ff8800;
        }

        [data-theme="purple"] {
            --primary: #aa66ff;
            --primary-dim: #6633aa;
            --primary-dark: #331166;
            --primary-light: #aa66ff33;
            --text: #aa66ff;
        }

		/* Amber Classic */
		[data-theme="amber"] {
			--primary: #ffb000;
			--primary-dim: #cc8800;
			--primary-dark: #805500;
			--primary-light: #ffb00033;
			--text: #ffb000;
		}

		/* Retro Red */
		[data-theme="red"] {
			--primary: #ff3333;
			--primary-dim: #cc0000;
			--primary-dark: #660000;
			--primary-light: #ff333333;
			--text: #ff3333;
		}

		/* Cyan */
		[data-theme="cyan"] {
			--primary: #00ffff;
			--primary-dim: #00aaaa;
			--primary-dark: #006666;
			--primary-light: #00ffff33;
			--text: #00ffff;
		}

		/* Hot Pink */
		[data-theme="pink"] {
			--primary: #ff00ff;
			--primary-dim: #aa00aa;
			--primary-dark: #550055;
			--primary-light: #ff00ff33;
			--text: #ff00ff;
		}

		/* White Phosphor */
		[data-theme="white"] {
			--primary: #ffffff;
			--primary-dim: #cccccc;
			--primary-dark: #666666;
			--primary-light: #ffffff33;
			--text: #ffffff;
		}

		/* Vintage Yellow */
		[data-theme="yellow"] {
			--primary: #ffff00;
			--primary-dim: #cccc00;
			--primary-dark: #666600;
			--primary-light: #ffff0033;
			--text: #ffff00;
		}
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'VT323', monospace;
            background: var(--bg);
            height: 100vh;
            overflow: hidden;
            cursor: default;
            user-select: none;
        }

        /* Desktop */
        .desktop {
            width: 100vw;
            height: 100vh;
            background: var(--bg);
            position: relative;
            overflow: hidden;
            filter: blur(0.2px);
        }

        .desktop::before {
            content: '';
            position: absolute;
            inset: 0;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                var(--primary-light) 2px,
                var(--primary-light) 4px
            );
            pointer-events: none;
        }

        /* Boot Screen */
        .boot-screen {
            position: fixed;
            inset: 0;
            background: var(--bg);
            color: var(--text);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            filter: blur(0.6px);
            animation: bootFadeOut 3s ease-out 2s forwards;
        }

        .boot-text {
            font-size: 18px;
            text-align: center;
            line-height: 1.6;
        }

        .boot-progress {
            margin-top: 20px;
            width: 300px;
            height: 20px;
            border: 1px solid var(--primary);
            background: var(--primary-light);
        }

        .boot-progress-bar {
            height: 100%;
            background: var(--primary);
            animation: bootProgress 2s ease-out forwards;
        }

        /* Theme Button */
        .theme-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: var(--primary);
            border: 1px solid var(--primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: var(--bg);
            transition: all 0.3s;
            z-index: 100;
        }

        .theme-button:hover {
            background: var(--bg);
            color: var(--primary);
            transform: scale(1.1);
        }

        /* Folders */
        .folder {
            position: absolute;
            width: 80px;
            height: 90px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.4s;
        }

        .folder:hover {
            transform: scale(1.05);
        }

        .folder-icon {
            width: 60px;
            height: 48px;
            background: var(--primary);
            border: 1px solid var(--primary);
            position: relative;
        }

        .folder-icon::before {
            content: '';
            position: absolute;
            top: -2px;
            left: 8px;
            width: 20px;
            height: 2px;
            background: var(--primary);
            border: 1px solid var(--primary);
            border-bottom: none;
        }

        .folder-label {
            margin-top: 8px;
            color: var(--text);
            font-size: 12px;
            text-align: center;
            max-width: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Windows */
        .window {
            position: absolute;
            background: var(--bg);
            border: 1px solid var(--primary);
            min-width: 300px;
            min-height: 200px;
            display: none;
            filter: blur(0.3px);
            opacity: 0;
            transform: scale(0.99);
            transition: all 0.15s;
            resize: both;
            overflow: auto;
        }

        .window.active {
            display: block;
            opacity: 1;
            transform: scale(1);
        }

        .window-header {
            background: var(--primary);
            color: var(--bg);
            padding: 8px 12px;
            font-size: 14px;
            border-bottom: 1px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
        }

        .window-controls {
            display: flex;
            gap: 6px;
        }

        .window-control {
            width: 18px;
            height: 18px;
            border: 1px solid var(--bg);
            background: var(--primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            transition: all 0.2s;
        }

        .window-control:hover {
            background: var(--bg);
            color: var(--primary);
            border-color: var(--primary);
        }

        .window-content {
            padding: 16px;
            height: calc(100% - 40px);
            overflow-y: auto;
            color: var(--text);
        }

        /* Custom Scrollbar */
        .window-content::-webkit-scrollbar {
            width: 16px;
            background: var(--bg);
        }

        .window-content::-webkit-scrollbar-track {
            background: var(--bg);
            border: 1px solid var(--primary);
            border-left: none;
        }

        .window-content::-webkit-scrollbar-thumb {
            background: var(--primary);
            border: 1px solid var(--bg);
        }

        /* File List */
        .file-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background: var(--bg);
            border: 1px solid var(--primary);
            cursor: pointer;
            margin: 2px 0;
        }

        .file-item:hover {
            background: var(--primary);
            color: var(--bg);
        }

        .file-icon {
            margin-right: 12px;
            font-size: 16px;
            width: 20px;
        }

        .file-name {
            flex: 1;
            font-size: 13px;
        }

        .file-size {
            font-size: 11px;
            opacity: 0.7;
        }

        /* Network Viewer */
        .network-viewer {
            width: 100%;
            height: 100%;
            background: var(--bg);
            position: relative;
        }

        .network-info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--bg);
            padding: 8px;
            border: 1px solid var(--primary);
            font-size: 12px;
            z-index: 10;
        }

        /* System Info */
        .system-info {
            position: absolute;
            top: 20px;
            right: 20px;
            color: var(--text);
            font-size: 14px;
            text-align: right;
            opacity: 0.7;
        }

        .version-watermark {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: var(--primary-dark);
            font-size: 24px;
            font-weight: bold;
            opacity: 0.3;
            pointer-events: none;
        }

        /* Animations */
        @keyframes bootFadeOut {
            to { opacity: 0; visibility: hidden; }
        }

        @keyframes bootProgress {
            to { width: 100%; }
        }

        @keyframes subtleGlow {
            0%, 95%, 100% { 
                text-shadow: none;
                box-shadow: none;
            }
            97% { 
                text-shadow: 0 0 2px var(--primary);
                box-shadow: 0 0 3px var(--primary-light);
            }
        }

        .folder-icon,
        .folder-label,
        .window-header,
        .window-content,
        .file-item {
            animation: subtleGlow 15s infinite;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .folder {
                width: 70px;
                height: 80px;
            }
            
            .folder-icon {
                width: 50px;
                height: 40px;
            }
            
            .system-info {
                font-size: 12px;
                top: 10px;
                right: 10px;
            }
            
            .window {
                min-width: 250px;
                min-height: 180px;
            }
        }
    </style>
</head>
<body data-theme="green">
    <!-- Boot Screen -->
    <div class="boot-screen" id="bootScreen">
        <div class="boot-text">
            FILMNET OS 1.0<br>
            Collaborative Intelligence System<br>
            Initializing pattern recognition modules...<br>
            Loading network topology engine...<br>
            Establishing anonymous session...
        </div>
        <div class="boot-progress">
            <div class="boot-progress-bar"></div>
        </div>
    </div>

    <!-- Desktop -->
    <div class="desktop" id="desktop">
        <!-- System Info -->
        <div class="system-info">
            FILMNET OS 1.0<br>
            BUILD 1982.11.25<br>
            ANONYMOUS USER<br>
            <span id="systemTime"></span>
        </div>

        <!-- Version Watermark -->
        <div class="version-watermark">FILMNET OS 1.0</div>

        <!-- Theme Button -->
        <button class="theme-button" id="themeButton" title="Change color scheme">◐</button>

        <!-- Desktop Folders -->
        <div class="folder" style="top: 80px; left: 20px;" data-folder="networks">
            <div class="folder-icon"></div>
            <div class="folder-label">NETWORKS</div>
        </div>

        <div class="folder" style="top: 180px; left: 20px;" data-folder="analysis">
            <div class="folder-icon"></div>
            <div class="folder-label">ANALYSIS</div>
        </div>

        <div class="folder" style="top: 280px; left: 20px;" data-folder="insights">
            <div class="folder-icon"></div>
            <div class="folder-label">INSIGHTS</div>
        </div>

        <div class="folder" style="top: 380px; left: 20px;" data-folder="collaborative">
            <div class="folder-icon"></div>
            <div class="folder-label">COLLAB</div>
        </div>

        <div class="folder" style="top: 480px; left: 20px;" data-folder="system">
            <div class="folder-icon"></div>
            <div class="folder-label">SYSTEM</div>
        </div>
    </div>

    <!-- Window Templates - dynamically created in JS -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script>
        // Configuration
        const config = {
            themes: ['green', 'blue', 'orange', 'purple', 'amber', 'red', 'cyan', 'pink', 'white', 'yellow'],
            currentTheme: 0,
            windowZIndex: 1000,
            windows: {
                networks: {
                    title: 'NETWORKS - Directory Listing',
                    files: [
                        { icon: '▲', name: 'complete_network.dat', size: '847KB' },
                        { icon: '▲', name: 'directors_only.dat', size: '234KB' },
                        { icon: '▲', name: 'producers_web.dat', size: '156KB' },
                        { icon: '▲', name: 'composers_cluster.dat', size: '98KB' }
                    ]
                },
                analysis: {
                    title: 'ANALYSIS - Directory Listing',
                    files: [
                        { icon: '■', name: 'centrality_metrics.rpt', size: '45KB' },
                        { icon: '■', name: 'cluster_analysis.rpt', size: '67KB' },
                        { icon: '■', name: 'influence_mapping.rpt', size: '89KB' }
                    ]
                },
                insights: {
                    title: 'INSIGHTS - Directory Listing',
                    files: [
                        { icon: '◆', name: 'joel_silver_empire.txt', size: '12KB' },
                        { icon: '◆', name: 'cameron_network.txt', size: '8KB' },
                        { icon: '◆', name: '80s_action_dna.txt', size: '15KB' },
                        { icon: '◆', name: 'bruckheimer_evolution.txt', size: '9KB' }
                    ]
                }
            }
        };

        // Window Management
        class WindowManager {
            constructor() {
                this.activeWindow = null;
                this.draggedWindow = null;
                this.dragOffset = { x: 0, y: 0 };
                this.windowPositions = {};
                this.setupEventListeners();
            }

            createWindow(type) {
                const existingWindow = document.getElementById(`${type}Window`);
                if (existingWindow) {
                    this.openWindow(existingWindow);
                    return;
                }

                const windowData = config.windows[type];
                if (!windowData) return;

                const window = document.createElement('div');
                window.className = 'window';
                window.id = `${type}Window`;
                
                // Random position
                const x = 100 + Math.random() * 300;
                const y = 100 + Math.random() * 200;
                window.style.cssText = `top: ${y}px; left: ${x}px; width: 400px; height: 300px;`;

                window.innerHTML = `
                    <div class="window-header">
                        <div class="window-title">${windowData.title}</div>
                        <div class="window-controls">
                            <div class="window-control minimize">_</div>
                            <div class="window-control maximize">□</div>
                            <div class="window-control close">×</div>
                        </div>
                    </div>
                    <div class="window-content">
                        <div class="file-list">
                            ${windowData.files.map(file => `
                                <div class="file-item" data-file="${file.name}">
                                    <span class="file-icon">${file.icon}</span>
                                    <span class="file-name">${file.name}</span>
                                    <span class="file-size">${file.size}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;

                document.getElementById('desktop').appendChild(window);
                this.openWindow(window);
            }

            openWindow(window) {
                window.classList.add('active');
                window.style.zIndex = ++config.windowZIndex;
                this.activeWindow = window;
            }

            closeWindow(window) {
                window.classList.remove('active');
                if (this.activeWindow === window) {
                    this.activeWindow = null;
                }
                setTimeout(() => window.remove(), 150);
            }

            setupEventListeners() {
                // Window dragging
                document.addEventListener('mousedown', (e) => {
                    if (e.target.classList.contains('window-header') && 
                        !e.target.classList.contains('window-control')) {
                        this.startDrag(e);
                    }
                });

                document.addEventListener('mousemove', (e) => this.drag(e));
                document.addEventListener('mouseup', () => this.stopDrag());

                // Window controls
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('close')) {
                        this.closeWindow(e.target.closest('.window'));
                    } else if (e.target.classList.contains('minimize')) {
                        const window = e.target.closest('.window');
                        window.style.display = 'none';
                    } else if (e.target.classList.contains('maximize')) {
                        this.toggleMaximize(e.target.closest('.window'));
                    }
                });

                // Touch support
                document.addEventListener('touchstart', (e) => {
                    if (e.target.classList.contains('window-header') && 
                        !e.target.classList.contains('window-control')) {
                        this.startDrag(e.touches[0]);
                    }
                });
                
                document.addEventListener('touchmove', (e) => {
                    if (this.draggedWindow) {
                        e.preventDefault();
                        this.drag(e.touches[0]);
                    }
                });
                
                document.addEventListener('touchend', () => this.stopDrag());
            }

            startDrag(e) {
                this.draggedWindow = e.target.closest('.window');
                const rect = this.draggedWindow.getBoundingClientRect();
                this.dragOffset.x = (e.clientX || e.pageX) - rect.left;
                this.dragOffset.y = (e.clientY || e.pageY) - rect.top;
            }

            drag(e) {
                if (!this.draggedWindow) return;
                
                const x = (e.clientX || e.pageX) - this.dragOffset.x;
                const y = (e.clientY || e.pageY) - this.dragOffset.y;
                
                this.draggedWindow.style.left = Math.max(0, Math.min(x, window.innerWidth - this.draggedWindow.offsetWidth)) + 'px';
                this.draggedWindow.style.top = Math.max(0, Math.min(y, window.innerHeight - this.draggedWindow.offsetHeight)) + 'px';
            }

            stopDrag() {
                this.draggedWindow = null;
            }

            toggleMaximize(window) {
                if (window.dataset.maximized === 'true') {
                    // Restore
                    const pos = this.windowPositions[window.id];
                    if (pos) {
                        window.style.cssText = pos;
                    }
                    window.dataset.maximized = 'false';
                } else {
                    // Maximize
                    this.windowPositions[window.id] = window.style.cssText;
                    window.style.width = '100vw';
                    window.style.height = '100vh';
                    window.style.top = '0px';
                    window.style.left = '0px';
                    window.dataset.maximized = 'true';
                }
            }
        }

        // Network Visualization
        class NetworkViewer {
            constructor() {
                this.nodes = [
                    { id: "joel_silver", name: "Joel Silver", type: "producer", connections: 8 },
                    { id: "james_cameron", name: "James Cameron", type: "director", connections: 5 },
                    { id: "michael_kamen", name: "Michael Kamen", type: "composer", connections: 9 },
                    { id: "dean_cundey", name: "Dean Cundey", type: "cinematographer", connections: 7 },
                    { id: "jerry_bruckheimer", name: "Jerry Bruckheimer", type: "producer", connections: 7 },
                    { id: "ridley_scott", name: "Ridley Scott", type: "director", connections: 6 },
                    { id: "john_carpenter", name: "John Carpenter", type: "director", connections: 4 }
                ];
                
                this.links = [
                    { source: "joel_silver", target: "james_cameron" },
                    { source: "joel_silver", target: "michael_kamen" },
                    { source: "james_cameron", target: "dean_cundey" },
                    { source: "jerry_bruckheimer", target: "ridley_scott" },
                    { source: "dean_cundey", target: "john_carpenter" },
                    { source: "michael_kamen", target: "jerry_bruckheimer" }
                ];

                this.roleColors = {
                    producer: "#00ffff",
                    director: "#ffff00", 
                    composer: "#ff8800",
                    cinematographer: "#00ff88"
                };
            }

            create(filename) {
                const window = document.createElement('div');
                window.className = 'window';
                window.id = 'networkViewerWindow';
                window.style.cssText = 'top: 120px; left: 350px; width: 600px; height: 450px;';

                window.innerHTML = `
                    <div class="window-header">
                        <div class="window-title">Network Viewer - ${filename}</div>
                        <div class="window-controls">
                            <div class="window-control minimize">_</div>
                            <div class="window-control maximize">□</div>
                            <div class="window-control close">×</div>
                        </div>
                    </div>
                    <div class="window-content" style="padding: 0;">
                        <div class="network-viewer">
                            <div class="network-info">
                                Loading network topology...<br>
                                Nodes: ${this.nodes.length}<br>
                                Connections: ${this.links.length}<br>
                                Pattern depth: Level 1
                            </div>
                            <svg id="networkSvg" width="100%" height="100%"></svg>
                        </div>
                    </div>
                `;

                document.getElementById('desktop').appendChild(window);
                windowManager.openWindow(window);
                
                setTimeout(() => this.render(), 300);
            }

            render() {
                const svg = d3.select("#networkSvg");
                svg.selectAll("*").remove();
                
                const container = svg.node().parentNode;
                const width = container.clientWidth;
                const height = container.clientHeight;

                // Position nodes in circle
                this.nodes.forEach((d, i) => {
                    const angle = (i / this.nodes.length) * 2 * Math.PI;
                    const radius = Math.min(width, height) * 0.3;
                    d.x = width/2 + Math.cos(angle) * radius;
                    d.y = height/2 + Math.sin(angle) * radius;
                });

                const simulation = d3.forceSimulation(this.nodes)
                    .force("link", d3.forceLink(this.links).id(d => d.id).distance(80))
                    .force("charge", d3.forceManyBody().strength(-200))
                    .force("center", d3.forceCenter(width / 2, height / 2))
                    .alpha(0.3)
                    .alphaDecay(0.02);

                const g = svg.append("g");

                const link = g.append("g")
                    .selectAll("line")
                    .data(this.links)
                    .enter().append("line")
                    .attr("stroke", "var(--primary-dark)")
                    .attr("stroke-width", 2);

                const node = g.append("g")
                    .selectAll("g")
                    .data(this.nodes)
                    .enter().append("g")
                    .style("cursor", "pointer")
                    .call(d3.drag()
                        .on("start", dragstarted)
                        .on("drag", dragged)
                        .on("end", dragended));

                node.append("circle")
                    .attr("r", d => Math.sqrt(d.connections) * 3 + 6)
                    .attr("fill", d => this.roleColors[d.type] || "var(--primary)")
                    .attr("stroke", "var(--primary)")
                    .attr("stroke-width", 1);

                node.append("text")
                    .attr("dy", -15)
                    .attr("text-anchor", "middle")
                    .style("fill", "var(--text)")
                    .style("font-family", "VT323, monospace")
                    .style("font-size", "11px")
                    .text(d => d.name.split(" ")[1] || d.name);

                // Node click handler
                node.on("click", (event, d) => {
                    node.selectAll("circle").attr("fill", n => this.roleColors[n.type] || "var(--primary)");
                    link.attr("stroke", "var(--primary-dark)").attr("stroke-width", 2);
                    
                    d3.select(event.currentTarget).select("circle").attr("fill", "#ffffff");
                    
                    link.filter(l => l.source.id === d.id || l.target.id === d.id)
                        .attr("stroke", "var(--primary)")
                        .attr("stroke-width", 3);
                });

                simulation.on("tick", () => {
                    link
                        .attr("x1", d => d.source.x)
                        .attr("y1", d => d.source.y)
                        .attr("x2", d => d.target.x)
                        .attr("y2", d => d.target.y);

                    node.attr("transform", d => `translate(${d.x},${d.y})`);
                });

                function dragstarted(event, d) {
                    if (!event.active) simulation.alphaTarget(0.3).restart();
                    d.fx = d.x;
                    d.fy = d.y;
                }

                function dragged(event, d) {
                    d.fx = event.x;
                    d.fy = event.y;
                }

                function dragended(event, d) {
                    if (!event.active) simulation.alphaTarget(0);
                    d.fx = null;
                    d.fy = null;
                }
            }
        }

        // Initialize
        const windowManager = new WindowManager();
        const networkViewer = new NetworkViewer();

        // System time
        function updateSystemTime() {
            const now = new Date();
            document.getElementById('systemTime').textContent = now.toLocaleTimeString('en-US', { hour12: false });
        }
        setInterval(updateSystemTime, 1000);
        updateSystemTime();

        // Theme cycling
        document.getElementById('themeButton').addEventListener('click', () => {
            config.currentTheme = (config.currentTheme + 1) % config.themes.length;
            document.body.setAttribute('data-theme', config.themes[config.currentTheme]);
        });

        // Folder clicks
        document.querySelectorAll('.folder').forEach(folder => {
            folder.addEventListener('click', function() {
                windowManager.createWindow(this.dataset.folder);
            });
        });

        // File clicks
        document.addEventListener('click', (e) => {
            const fileItem = e.target.closest('.file-item');
            if (fileItem && fileItem.dataset.file && fileItem.dataset.file.endsWith('.dat')) {
                // Close existing network viewer
                const existing = document.getElementById('networkViewerWindow');
                if (existing) existing.remove();
                
                networkViewer.create(fileItem.dataset.file);
            }
        });

        // Remove boot screen
        setTimeout(() => {
            document.getElementById('bootScreen').style.display = 'none';
        }, 5000);
    </script>
</body>
</html>